<!-- X1_Bounty_A1_Cemetery_Event_JarOfSouls (349016)   -->
<Profile>
<Name>Jar of Souls (349016)</Name>
<KillMonsters>True</KillMonsters>
<PickupLoot>true</PickupLoot>
<GameParams act="OpenWorld" resumeFromSave="False" isPrivate="True" numGames="-1" />
<Order>
	<ToggleTargeting questId="1" stepId="2" looting="True" killRadius="31" />

	<If condition="Me.IsInTown==False"><TrinityTownPortal questId="1" /></If>
	<WaitTimer questId="1" stepId="2" waitTime="1000" />			
	<UseWaypoint waypointNumber="7" questId="1"/>	
	<WaitTimer questId="1" stepId="2" waitTime="3500" />		
	<If condition="HasQuest(349016)">
	
		<!--  Cemetery of the Forsaken  -->
		<LogMessage message="looking for marker" />
		<If condition="CurrentWorldId == 71150">
		
			<SafeMoveTo questId="1" stepId="2" x="2032" y="1776" z="1" pathPrecision="5" pathPointLimit="250" statusText="" name="Crypt Location North"/>
			<If condition="CurrentWorldId == 71150 and MarkerExistsAt(-1965109038, 2032.983, 1776.411, 1.434785, 30)">
				<LogMessage message="found marker in North (2032, 1776) - moving there" />
				<MoveToActor questId="1" stepId="2" actorId="176002" isPortal="True" destinationWorldId="72636" interactRange="20"  />
				<WaitTimer questId="1" stepId="2" waitTime="2000" />
			</If>
			
			<SafeMoveTo questId="1" stepId="2" x="2233" y="1793" z="-4" pathPrecision="5" pathPointLimit="250" statusText="" name="Crypt Location South"/>	
			<If condition="CurrentWorldId == 71150 and MarkerExistsAt(-1965109038, 2233, 1793, 6, 30)">
				<LogMessage message="found marker in West (2233, 1793) - moving there" />
				<MoveToActor questId="1" stepId="2" actorId="176002" isPortal="True" destinationWorldId="72636" interactRange="20"  />
				<WaitTimer questId="1" stepId="2" waitTime="2000" />
			</If>		
			
			<SafeMoveTo questId="1" stepId="2" x="2062" y="1950" z="-5" pathPrecision="5" pathPointLimit="250" statusText="" name="Crypt Location East"/>
			<If condition="CurrentWorldId == 71150 and MarkerExistsAt(-1965109038, 2062, 1950, -5, 30)">
				<LogMessage message="found marker in East (2062, 1950) - moving there" />
				<MoveToActor questId="1" stepId="2" actorId="176002" isPortal="True" destinationWorldId="72636" interactRange="20"  />
				<WaitTimer questId="1" stepId="2" waitTime="2000" />
			</If>		
			
			<SafeMoveTo questId="1" stepId="2" x="2173" y="1941" z="6" pathPrecision="5" pathPointLimit="250" statusText="" name="Crypt Location West"/> 
			<If condition="CurrentWorldId == 71150 and MarkerExistsAt(-1965109038, 2173, 1941, -4, 30)">
				<LogMessage message="found marker in South (2173, 1941) - moving there" />
				<MoveToActor questId="1" stepId="2" actorId="176002" isPortal="True" destinationWorldId="72636" interactRange="20"  />
				<WaitTimer questId="1" stepId="2" waitTime="2000" />
			</If>
		</If>

		<!--  Defiled Crypt -->
		<If condition="CurrentWorldId == 72636">
			<!-- Find the Jar of Souls -->
			<TrinityExploreDungeon questId="1" stepId="2" until="ObjectFound" actorId="93713" boxSize="15" boxTolerance="0.35" objectDistance="55" statusText="Searching for unopened jar">
				<AlternateActors>
					<AlternateActor actorId="219334" objectDistance="100" />
					<LogMessage message="Found opened jar"/>
				</AlternateActors>
			</TrinityExploreDungeon>
			<MoveToActor questId="1" stepId="2" actorId="93713" />
			<!-- giving enemies a 5 second head start to let them close in on us and keep us tight on jar -->
			<WaitTimer questId="1" stepId="2" waitTime="5000" />
			<TrinityExploreDungeon questId="1" stepId="2" until="ObjectFound" actorId="219334" boxSize="15" boxTolerance="0.35" objectDistance="55" statusText="Searching for open jar">
			</TrinityExploreDungeon>
			<MoveToActor questId="1" stepId="2"  actorId="219334" interactRange="8" />
			<!-- make sure bounty is complete! -->
			<TrinityExploreDungeon questId="1" stepId="2" until="BountyComplete" pathPrecision="20" boxSize="15" boxTolerance="0.35" stayAfterBounty="False"/>				
		</If>
	</If>
	<!-- give legendaries a moment to fall from the heavens... -->
	<WaitTimer questId="1" stepId="2" waitTime="3000" />
	<LoadProfile file="act1.xml" />	
</Order>
</Profile>