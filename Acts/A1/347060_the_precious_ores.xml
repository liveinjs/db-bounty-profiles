<!--  -->
<Profile>
<Name>The Precious Ores (347060)</Name>
<KillMonsters>True</KillMonsters>
<PickupLoot>true</PickupLoot>
<GameParams act="OpenWorld" resumeFromSave="False" isPrivate="True" numGames="-1" />
<Order>

	<If condition="Me.IsInTown==False"><TrinityTownPortal questId="1" /></If>
	<WaitTimer questId="1" stepId="2" waitTime="2500" />		
	<UseWaypoint waypointNumber="8" questId="1"/>
	<WaitTimer questId="1" stepId="2" waitTime="2000" />	
	<If condition="HasQuest(347060)">
	
		<ToggleTargeting questId="1" stepId="1" killRadius="31" />	
	
		<!-- Middle Cave Location 1 -->
		<If condition="CurrentWorldId == 71150">			
			<SafeMoveTo questId="312429" stepId="2" x="2068" y="896" z="0" pathPrecision="5" pathPointLimit="250" statusText="Middle Cave Location 1" /> 
			<MoveToActor questId="1" stepId="2" actorId="176038" isPortal="True" destinationWorldId="82370"/>
		</If>	
		
		<!-- Middle Cave Location 2 -->
		<If condition="CurrentWorldId == 71150">		
			<SafeMoveTo questId="312429" stepId="2" x="2120" y="612" z="0" pathPrecision="5" pathPointLimit="250" statusText="Middle Cave Location 2" /> 
			<MoveToActor questId="1" stepId="2" actorId="176038" isPortal="True" destinationWorldId="82370"/>
		</If>	
		
		<!-- Bottom Cave Location -->
		<If condition="CurrentWorldId == 71150">		
			<SafeMoveTo questId="312429" stepId="2" x="2242" y="1054" z="0" pathPrecision="5" pathPointLimit="250" statusText="Bottom Cave Location" /> 
			<MoveToActor questId="1" stepId="2" actorId="176038" isPortal="True" destinationWorldId="82370"/>
		</If>	
		
		<!-- Top Cave Location -->
		<If condition="CurrentWorldId == 71150">			
			<SafeMoveTo questId="312429" stepId="2" x="1770" y="369" z="0" pathPrecision="5" pathPointLimit="250" statusText="Top Cave Location" /> 
			<MoveToActor questId="1" stepId="2" actorId="176038" isPortal="True" destinationWorldId="82370"/>
		</If>	
		
		<!-- Search Everywhere for cave entrance -->
		<If condition="CurrentWorldId == 71150">
		  <TrinityExploreDungeon questId="1" stepId="2" boxTolerance="0.18" boxSize="20" until="ExitFound" exitNameHash="-431250552" ignoreMarkers="False" statusText="TrinityDungeonExplore for Cave Location">
				<IgnoreScenes>
					<IgnoreScene sceneId="78212" /> <!-- exit top -->	
					<IgnoreScene sceneName="_E02_S02" /> <!-- exit top -->	
					<IgnoreScene sceneId="74617" /> <!-- exit bottom -->	
					<IgnoreScene sceneName="_E01_S01" /> <!-- exit bottom -->											
				</IgnoreScenes>				
			</TrinityExploreDungeon>		  
		  <MoveToMapMarker questId="1" stepId="2" exitNameHash="-431250552" destinationWorldId="82370" interactRange="20"  />
		</If>

		<If condition="CurrentWorldId == 82370">
			<WaitTimer questId="1" stepId="2" waitTime="2000" />
			<TrinityExploreDungeon questId="1" stepId="2" boxTolerance="0.18" boxSize="20" until="ExitFound" exitNameHash="-431250551" ignoreMarkers="False">
				<PrioritizeScenes>
					<PriorityScene sceneName="Exit" />
				</PrioritizeScenes>		
			</TrinityExploreDungeon>
			<MoveToMapMarker questId="1" stepId="2" exitNameHash="-431250551" destinationWorldId="82371" interactRange="20"  />
			<WaitTimer questId="72095" stepId="11" waitTime="1000" />
		</If>
		
		<If condition="CurrentWorldId == 82371">
		
			<MoveToActor questId="1" stepId="2" actorId="107076" />
		
			<!-- Find one of the ores -->			
			<TrinityExploreDungeon questId="1" stepId="2" until="ObjectFound" actorId="202277" boxTolerance="0.10" boxSize="12" objectDistance="45">
				<AlternateActors>
					<AlternateActor actorId="204032" objectDistance="45" />
				</AlternateActors>			
			</TrinityExploreDungeon>
			
			<!-- Find the other ore -->	 
			<If condition="HasQuest(347060) and ActorExistsAt(202277, Me.Position.X, Me.Position.Y, Me.Position.Z, 150)">
				<MoveToActor questId="1" stepId="2" timeout="15000" actorId="202277" />				
				<TrinityExploreDungeon questId="1" stepId="2" until="ObjectFound" actorId="204032" boxTolerance="0.10" boxSize="12" objectDistance="80" stayAfterBounty="False" />
				<MoveToActor questId="1" stepId="2" timeout="15000" actorId="204032" />					
			</If>
			<If condition="HasQuest(347060) and ActorExistsAt(204032, Me.Position.X, Me.Position.Y, Me.Position.Z, 150)">
				<MoveToActor questId="1" stepId="2" timeout="15000" actorId="204032" />				
				<TrinityExploreDungeon questId="1" stepId="2" until="ObjectFound" actorId="202277" boxTolerance="0.10" boxSize="12" objectDistance="80"  stayAfterBounty="False" />
				<MoveToActor questId="1" stepId="2" timeout="15000" actorId="202277" />					
			</If>			
			
			<!-- fight off the scavengers and finish it -->		
			<If condition="HasQuest(347060)">			
				<WaitTimer questId="1" stepId="2" waitTime="10000" />
			</If>	
			<If condition="HasQuest(347060)">
				<MoveToActor questId="1" timeout="5000" stepId="2" actorId="107076" />
			</If>	
			<If condition="HasQuest(347060)">
				<WaitTimer questId="1" stepId="2" waitTime="7000" />
			</If>	
			
		</If>
		
	</If>
	
	<!-- not sure if we need to reset kill radius, do it just in case -->
	<ToggleTargeting questId="1" stepId="1" killRadius="80" />	
		
	<LoadProfile file="act1.xml" />
	
</Order>
</Profile>